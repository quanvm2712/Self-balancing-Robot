/*
 * 010i2c_master_tx_testing.c
 *
 *  Created on: Feb 24, 2019
 *      Author: admin
 */



#include "stm32f407xx.h"

USART_HandleTypeDef USART2_Handle;
char data = 'c';

void delay(void)
{
	for(uint32_t i = 0 ; i < 500000/2 ; i ++);
}


void USART2_Init(void)
{
	USART2_Handle.pUSARTx = USART2;
	USART2_Handle.Init.BaudRate = USART_BAUDRATE_9600;
	USART2_Handle.Init.HWFlowControl = USART_HW_NONE;
	USART2_Handle.Init.Mode = USART_MODE_TX;
	USART2_Handle.Init.StopBits = USART_STOPBITS_1;
	USART2_Handle.Init.WordLength = USART_WORDLENGTH_8BITS;
	USART2_Handle.Init.ParityControl = USART_PARITY_NONE;
	USART_Init(&USART2_Handle);

}

void USART2_GPIOInit(void)
{
	GPIO_HandleTypeDef usart_gpios;

	usart_gpios.pGPIOx = GPIOA;
	usart_gpios.Init.Mode = GPIO_MODE_AF;
	usart_gpios.Init.OPType = GPIO_OPTYPE_PP;
	usart_gpios.Init.Pull = GPIO_PULLUP;
	usart_gpios.Init.Speed = GPIO_SPEED_FAST;
	usart_gpios.Init.Alternate =7;

	//USART2 TX
	usart_gpios.Init.Pin  = GPIO_PIN_2;
	GPIO_Init(&usart_gpios);

	//USART2 RX
	usart_gpios.Init.Pin = GPIO_PIN_3;
	GPIO_Init(&usart_gpios);

}


int main(void)
{
	//Init USART Parameter
	memset(&USART2_Handle, 0, sizeof(USART2_Handle));

	//USART_SetParam(USART2_Handle, USART2, USART_MODE_TX, USART_STOPBITS_1, USART_WORDLENGTH_8BITS, USART_PARITY_NONE, USART_BAUDRATE_9600);


	USART_PeripheralControl(USART2, ENABLE);

	while (1)
	{
		USART_Transmit(&USART2_Handle, (uint8_t*)&data, 1);
		delay();

	}

}


//#include<stdio.h>
//#include<string.h>
//#include "stm32f407xx.h"
//
//char msg[1024] = "UART Tx testing...\n\r";
//
//USART_HandleTypeDef usart2_handle;
//
//void USART2_Init(void)
//{
//	usart2_handle.pUSARTx = USART2;
//	usart2_handle.Init.BaudRate = USART_BAUDRATE_9600;
//	usart2_handle.Init.HWFlowControl = USART_HW_NONE;
//	usart2_handle.Init.Mode = USART_MODE_TX;
//	usart2_handle.Init.StopBits = USART_STOPBITS_1;
//	usart2_handle.Init.WordLength = USART_WORDLENGTH_8BITS;
//	usart2_handle.Init.ParityControl = USART_PARITY_NONE;
//	USART_Init(&usart2_handle);
//}
//
//void USART2_GPIOInit(void)
//{
//	GPIO_HandleTypeDef usart_gpios;
//
//	usart_gpios.pGPIOx = GPIOA;
//	usart_gpios.Init.Mode = GPIO_MODE_AF;
//	usart_gpios.Init.OPType = GPIO_OPTYPE_PP;
//	usart_gpios.Init.Pull = GPIO_PULLUP;
//	usart_gpios.Init.Speed = GPIO_SPEED_FAST;
//	usart_gpios.Init.Alternate =7;
//
//	//USART2 TX
//	usart_gpios.Init.Pin  = GPIO_PIN_2;
//	GPIO_Init(&usart_gpios);
//
//	//USART2 RX
//	usart_gpios.Init.Pin = GPIO_PIN_3;
//	GPIO_Init(&usart_gpios);
//
//}
//
//
//void delay(void)
//{
//	for(uint32_t i = 0 ; i < 500000/2 ; i ++);
//}
//
//
//int main(void)
//{
//
//
//	USART2_GPIOInit();
//
//    USART2_Init();
//
//    USART_PeripheralControl(USART2,ENABLE);
//
//
//    USART_Transmit(&usart2_handle,(uint8_t*)msg,strlen(msg));
//
//	return 0;
//}
